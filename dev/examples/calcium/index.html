<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Calcium channel model · Bifurcations.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>Bifurcations.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../">Home</a></li><li><a class="toctext" href="../../api/">API</a></li><li><span class="toctext">Examples</span><ul><li class="current"><a class="toctext" href>Calcium channel model</a><ul class="internal"></ul></li><li><a class="toctext" href="../van_der_pol/">Continuation of limit cycles of the van der Pol oscillator</a></li><li><a class="toctext" href="../morris_lecar/">Modified Morris-Lecar model</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Examples</li><li><a href>Calcium channel model</a></li></ul><a class="edit-page" href="https://github.com/tkf/Bifurcations.jl/blob/master/docs/src/examples/calcium.md#L"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Calcium channel model</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Calcium-channel-model-1" href="#Calcium-channel-model-1">Calcium channel model</a></h1><p>Calcium channel model taken from PyDSTool example.  See:</p><ul><li><a href="https://github.com/robclewley/pydstool/blob/master/examples/Tutorial_Calcium.py">pydstool/Tutorial_Calcium.py at master · robclewley/pydstool</a></li><li><a href="http://www2.gsu.edu/~matrhc/Tutorial.html">Tutorial - PyDSTool Wiki</a></li><li><a href="http://docs.juliadiffeq.org/latest/analysis/bifurcation.html">Bifurcation Analysis · DifferentialEquations.jl</a></li></ul><p>Use <a href="https://github.com/cstjean/QuickTypes.jl"><code>QuickTypes.@qstruct_fp</code></a> to define model parameter:</p><div><pre><code class="language-julia">using QuickTypes: @qstruct_fp

@qstruct_fp CalciumParam(
    vl = -60,
    vca = 120,
    i = -220.0,
    gl = 2,
    gca = 4,
    c = 20,
    v1 = -1.2,
    v2 = 18,
)</code></pre></div><p>Define the model as in <a href="http://docs.juliadiffeq.org/latest/tutorials/ode_example.html">DifferentialEquations.jl</a>:</p><div><pre><code class="language-julia">using Parameters: @unpack

function f(u, p::CalciumParam, t)
    @unpack vl, vca, i, gl, gca, c, v1, v2 = p
    v = u[1]
    w = u[2]
    dv = (i + gl * (vl - v) - gca * 0.5 * (1 + tanh((v-v1)/v2)) * (v-vca)) / c
    dw = v-w
    return SVector(dv, dw)
end</code></pre><pre><code class="language-none">f (generic function with 1 method)</code></pre></div><p>Create an <a href="http://docs.juliadiffeq.org/latest/tutorials/ode_example.html"><code>ODEProblem</code></a>:</p><div><pre><code class="language-julia">using DiffEqBase: ODEProblem
using StaticArrays: SVector

u0 = SVector(-170.0, -170.0)
tspan = (0.0, 30.0)  # ignored by Bifurcations.jl
p = CalciumParam()
ode = ODEProblem(f, u0, tspan, p)</code></pre><pre><code class="language-none">ODEProblem with uType StaticArrays.SArray{Tuple{2},Float64,1,2} and tType Float64. In-place: false
timespan: (0.0, 30.0)
u0: [-170.0, -170.0]</code></pre></div><p>Create a bifurcation problem:</p><div><pre><code class="language-julia">using Bifurcations: BifurcationProblem
using Setfield: @lens

param_axis = @lens _.i
prob = BifurcationProblem(ode, param_axis, (-300.0, 100.0))</code></pre></div><p>Solve it:</p><div><pre><code class="language-julia">using DiffEqBase: init, solve!

solver = init(prob)
solve!(solver)
sol = solver.sol</code></pre><pre><code class="language-none">Codim1Solution &lt;Continuous&gt;
# sweeps             : 2
# points             : 106
# branches           : 0
# saddle_node        : 2</code></pre></div><p>Plot it:</p><div><pre><code class="language-julia">using Plots

plt = plot(sol)</code></pre></div><p><img src="../calcium-1.png" alt/></p><p>Find the left Saddle-Node bifurcation point:</p><div><pre><code class="language-julia">using Bifurcations: special_intervals

point_list = sort!(special_intervals(solver), by=p-&gt;p.u0[end])
point = point_list[1]</code></pre><pre><code class="language-none">SpecialPointInterval &lt;Continuous saddle_node&gt;
happened between:
  u0 = [15.36, 15.36, -210.476]
  u1 = [15.822, 15.822, -210.44]</code></pre></div><p>Numerical continuation of the Saddle-Node bifurcation point:</p><div><pre><code class="language-julia">sn_prob = BifurcationProblem(
    point,
    solver,
    (@lens _.gca),
    (0.0, 8.0),
)
sn_solver = init(sn_prob)
solve!(sn_solver)</code></pre><pre><code class="language-none">Codim2Solver &lt;Continuous&gt;
# sweeps             : 2
# points             : 68
# branches           : 0
# cusp               : 1</code></pre></div><p>Plot the phase diagram:</p><div><pre><code class="language-julia">plt2 = plot(sn_solver.sol)</code></pre></div><p><img src="../calcium-2.png" alt/></p><footer><hr/><a class="previous" href="../"><span class="direction">Previous</span><span class="title">Examples</span></a><a class="next" href="../van_der_pol/"><span class="direction">Next</span><span class="title">Continuation of limit cycles of the van der Pol oscillator</span></a></footer></article></body></html>
